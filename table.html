<!doctype html>
<html>
  <head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&amp;display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon"> 
    <link rel="stylesheet" href="css/common.css">
    <script src="d2data.js"></script>
  </head>
  <body>
    <table>
      <tbody>
        <tr>
          <td>
            <select id="file">
            </select>
          </td>
        </tr>
      </tbody>
    </table>
    <div id="content"></div>
    <script>
      const version = 's9'
      const files = [
        'Armor.txt',
        'CharStats.txt',
        'CubeMain.txt',
        'ItemStatCost.txt',
        'Levels.txt',
        'MagicPrefix.txt',
        'MagicSuffix.txt',
        'Misc.txt',
        'MonStats.txt',
        'MonStats2.txt',
        'MonType.txt',
        'Properties.txt',
        'Skilldesc.txt',
        'Skills.txt',
        'TreasureClassEx.txt',
        'UniqueItems.txt',
        'Weapons.txt',
      ]
      const loader = new DataLoader()
      function populate (container) {
        const select = document.querySelector('#file')
        select.innerHTML = ''
        files.forEach(file => {
          const el = document.createElement('option')
          el.textContent = file
          el.value = file
          select.appendChild(el)
        })
        select.onchange = e => {
          container.innerHTML = ''
          const raw = loader.get(version, select.value)
          new DataFrameView(raw).populate(container)
          window.table = raw
        }
        select.onchange()
      }
      async function Load () {
        await loader.preload(version, files)
        populate(document.querySelector('#content'))
      }
      requestAnimationFrame(Load)
    </script>
  </body>
</html>
